
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="ROS-Mosaico Bridge">
      
      
      
        <link rel="canonical" href="https://cabba.github.io/mosaico/SDK/bridges/ros/">
      
      
        <link rel="prev" href="../ml/">
      
      
        <link rel="next" href="../../../daemon/">
      
      
        
      
      
      <link rel="icon" href="../../../assets/favicon.svg">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.7.1">
    
    
      
        <title>ROS - Mosaico Documentation</title>
      
    
    
      <link rel="stylesheet" href="../../../assets/stylesheets/main.484c7ddc.min.css">
      
        
        <link rel="stylesheet" href="../../../assets/stylesheets/palette.ab4e12ef.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Manrope:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Manrope";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../../assets/_mkdocstrings.css">
    
      <link rel="stylesheet" href="../../../stylesheets/extra.css">
    
    <script>__md_scope=new URL("../../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="slate" data-md-color-primary="custom" data-md-color-accent="custom">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#architecture" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../../.." title="Mosaico Documentation" class="md-header__button md-logo" aria-label="Mosaico Documentation" data-md-component="logo">
      
  <img src="../../../assets/mosaico_logomark.svg" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Mosaico Documentation
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              ROS
            
          </span>
        </div>
      </div>
    </div>
    
      
    
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
      <div class="md-header__source">
        <a href="https://github.com/mosaico-labs/mosaico" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
            
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../../.." class="md-tabs__link">
        
  
  
    
  
  Mosaico

      </a>
    </li>
  

      
        
  
  
  
    
  
  
    
    
      <li class="md-tabs__item md-tabs__item--active">
        <a href="../../" class="md-tabs__link">
          
  
  
    
  
  SDK

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../daemon/" class="md-tabs__link">
          
  
  
    
  
  Daemon

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../development/release_cycle/" class="md-tabs__link">
          
  
  
    
  
  Development

        </a>
      </li>
    
  

      
    </ul>
  </div>
</nav>
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../.." title="Mosaico Documentation" class="md-nav__button md-logo" aria-label="Mosaico Documentation" data-md-component="logo">
      
  <img src="../../../assets/mosaico_logomark.svg" alt="logo">

    </a>
    Mosaico Documentation
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/mosaico-labs/mosaico" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../.." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Mosaico
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
        
        
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" checked>
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    
  
    SDK
  

    
  </span>
  
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_2" id="__nav_2_label" tabindex="">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            
  
    SDK
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../install/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    <span class="md-typeset">
      Setup
    </span>
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../client/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Client Architecture
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../ontology/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Data Models & Ontology
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
    
    
    
      
      
        
          
          
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_5" >
        
          
          <label class="md-nav__link" for="__nav_2_5" id="__nav_2_5_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    
  
    Data Handling
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_5">
            <span class="md-nav__icon md-icon"></span>
            
  
    Data Handling
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../handling/data-handling/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Writing & Reading Data
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../handling/writing/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    The Writing Workflow
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../handling/reading/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    The Reading Workflow
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../query/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Querying Catalogs
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    
    
      
        
      
        
      
    
    
    
      
      
        
          
          
        
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_7" checked>
        
          
          <label class="md-nav__link" for="__nav_2_7" id="__nav_2_7_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    
  
    Bridges
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_7_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_2_7">
            <span class="md-nav__icon md-icon"></span>
            
  
    Bridges
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../ml/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Machine Learning & Analytics
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    
  
    ROS
  

    
  </span>
  
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    
  
    ROS
  

    
  </span>
  
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#architecture" class="md-nav__link">
    <span class="md-ellipsis">
      
        <span class="md-typeset">
          Architecture
        </span>
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Architecture">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#the-loader-layer-rosloader" class="md-nav__link">
    <span class="md-ellipsis">
      
        <span class="md-typeset">
          The Loader Layer (<code>ROSLoader</code>)
        </span>
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#the-adaptation-layer-rosbridge-adapters" class="md-nav__link">
    <span class="md-ellipsis">
      
        <span class="md-typeset">
          The Adaptation Layer (<code>ROSBridge</code> &amp; Adapters)
        </span>
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="The Adaptation Layer (ROSBridge &amp; Adapters)">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#extending-the-bridge-custom-adapters" class="md-nav__link">
    <span class="md-ellipsis">
      
        <span class="md-typeset">
          Extending the Bridge (Custom Adapters)
        </span>
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#the-orchestrator-rosbaginjector" class="md-nav__link">
    <span class="md-ellipsis">
      
        <span class="md-typeset">
          The Orchestrator (<code>RosbagInjector</code>)
        </span>
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="The Orchestrator (RosbagInjector)">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#rosinjectionconfig" class="md-nav__link">
    <span class="md-ellipsis">
      
        <span class="md-typeset">
          <code>ROSInjectionConfig</code>
        </span>
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cli-usage" class="md-nav__link">
    <span class="md-ellipsis">
      
        <span class="md-typeset">
          CLI Usage
        </span>
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#programmatic-usage-python-script" class="md-nav__link">
    <span class="md-ellipsis">
      
        <span class="md-typeset">
          Programmatic Usage (Python Script)
        </span>
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#the-type-registry-rostyperegistry" class="md-nav__link">
    <span class="md-ellipsis">
      
        <span class="md-typeset">
          The Type Registry (<code>ROSTypeRegistry</code>)
        </span>
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="The Type Registry (ROSTypeRegistry)">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#centralized-custom-message-registration" class="md-nav__link">
    <span class="md-ellipsis">
      
        <span class="md-typeset">
          Centralized Custom Message Registration
        </span>
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#testing-validation" class="md-nav__link">
    <span class="md-ellipsis">
      
        <span class="md-typeset">
          Testing &amp; Validation
        </span>
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Testing &amp; Validation">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#recommended-dataset-for-verification" class="md-nav__link">
    <span class="md-ellipsis">
      
        <span class="md-typeset">
          Recommended Dataset for Verification
        </span>
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#known-issues-limitations" class="md-nav__link">
    <span class="md-ellipsis">
      
        <span class="md-typeset">
          Known Issues &amp; Limitations
        </span>
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#supported-message-types" class="md-nav__link">
    <span class="md-ellipsis">
      
        <span class="md-typeset">
          Supported Message Types
        </span>
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Supported Message Types">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#supported-message-types-table" class="md-nav__link">
    <span class="md-ellipsis">
      
        <span class="md-typeset">
          Supported Message Types Table
        </span>
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../daemon/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    
  
    Daemon
  

    
  </span>
  
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_3" id="__nav_3_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            
  
    Daemon
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../daemon/install/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    <span class="md-typeset">
      Setup
    </span>
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../daemon/control/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Control Channel
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../daemon/ingestion/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Ingestion Channel
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../daemon/query/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Query Engine
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../daemon/retrieval/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Retrieval Channel
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" >
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Development
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            
  
    Development
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../development/release_cycle/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    <span class="md-typeset">
      Release Cycle
    </span>
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#architecture" class="md-nav__link">
    <span class="md-ellipsis">
      
        <span class="md-typeset">
          Architecture
        </span>
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Architecture">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#the-loader-layer-rosloader" class="md-nav__link">
    <span class="md-ellipsis">
      
        <span class="md-typeset">
          The Loader Layer (<code>ROSLoader</code>)
        </span>
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#the-adaptation-layer-rosbridge-adapters" class="md-nav__link">
    <span class="md-ellipsis">
      
        <span class="md-typeset">
          The Adaptation Layer (<code>ROSBridge</code> &amp; Adapters)
        </span>
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="The Adaptation Layer (ROSBridge &amp; Adapters)">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#extending-the-bridge-custom-adapters" class="md-nav__link">
    <span class="md-ellipsis">
      
        <span class="md-typeset">
          Extending the Bridge (Custom Adapters)
        </span>
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#the-orchestrator-rosbaginjector" class="md-nav__link">
    <span class="md-ellipsis">
      
        <span class="md-typeset">
          The Orchestrator (<code>RosbagInjector</code>)
        </span>
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="The Orchestrator (RosbagInjector)">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#rosinjectionconfig" class="md-nav__link">
    <span class="md-ellipsis">
      
        <span class="md-typeset">
          <code>ROSInjectionConfig</code>
        </span>
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cli-usage" class="md-nav__link">
    <span class="md-ellipsis">
      
        <span class="md-typeset">
          CLI Usage
        </span>
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#programmatic-usage-python-script" class="md-nav__link">
    <span class="md-ellipsis">
      
        <span class="md-typeset">
          Programmatic Usage (Python Script)
        </span>
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#the-type-registry-rostyperegistry" class="md-nav__link">
    <span class="md-ellipsis">
      
        <span class="md-typeset">
          The Type Registry (<code>ROSTypeRegistry</code>)
        </span>
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="The Type Registry (ROSTypeRegistry)">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#centralized-custom-message-registration" class="md-nav__link">
    <span class="md-ellipsis">
      
        <span class="md-typeset">
          Centralized Custom Message Registration
        </span>
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#testing-validation" class="md-nav__link">
    <span class="md-ellipsis">
      
        <span class="md-typeset">
          Testing &amp; Validation
        </span>
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Testing &amp; Validation">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#recommended-dataset-for-verification" class="md-nav__link">
    <span class="md-ellipsis">
      
        <span class="md-typeset">
          Recommended Dataset for Verification
        </span>
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#known-issues-limitations" class="md-nav__link">
    <span class="md-ellipsis">
      
        <span class="md-typeset">
          Known Issues &amp; Limitations
        </span>
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#supported-message-types" class="md-nav__link">
    <span class="md-ellipsis">
      
        <span class="md-typeset">
          Supported Message Types
        </span>
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Supported Message Types">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#supported-message-types-table" class="md-nav__link">
    <span class="md-ellipsis">
      
        <span class="md-typeset">
          Supported Message Types Table
        </span>
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              
                



  


  <nav class="md-path" aria-label="Navigation" >
    <ol class="md-path__list">
      
        
  
  
    <li class="md-path__item">
      <a href="../../.." class="md-path__link">
        
  <span class="md-ellipsis">
    Mosaico
  </span>

      </a>
    </li>
  

      
      
        
  
  
    
    
      <li class="md-path__item">
        <a href="../../" class="md-path__link">
          
  <span class="md-ellipsis">
    SDK
  </span>

        </a>
      </li>
    
  

      
        
  
  
    
    
      <li class="md-path__item">
        <a href="../ml/" class="md-path__link">
          
  <span class="md-ellipsis">
    Bridges
  </span>

        </a>
      </li>
    
  

      
    </ol>
  </nav>

              
              <article class="md-content__inner md-typeset">
                
                  


  
  


  <h1>ROS</h1>

<p>The <strong>ROS Bridge</strong> module serves as the ingestion gateway for ROS (Robot Operating System) data into the Mosaico Data Platform. Its primary function is to solve the interoperability challenges associated with ROS bag filesâ€”specifically format fragmentation (ROS 1 <code>.bag</code> vs. ROS 2 <code>.mcap</code>/<code>.db3</code>) and the lack of strict schema enforcement in custom message definitions.</p>
<p>The core philosophy of the module is <strong>"Adaptation, Not Just Parsing."</strong> Rather than simply extracting raw dictionaries from ROS messages, the bridge actively translates them into the standardized <strong>Mosaico Ontology</strong>. For example, a <code>geometry_msgs/Pose</code> is validated, normalized, and instantiated as a strongly-typed <code>mosaicolabs.models.data.Pose</code> object before ingestion.</p>
<h2 id="architecture">Architecture</h2>
<p>The module is composed of four distinct layers that handle the pipeline from raw file access to server transmission.</p>
<h3 id="the-loader-layer-rosloader">The Loader Layer (<code>ROSLoader</code>)</h3>
<p>The <code>ROSLoader</code> acts as the abstraction layer over the physical bag files. It utilizes the <a href="https://pypi.org/project/rosbags/"><code>rosbags</code></a> library to provide a unified interface for reading both ROS 1 and ROS 2 formats (<code>.bag</code>, <code>.db3</code>, <code>.mcap</code>).</p>
<ul>
<li><strong>Responsibilities:</strong> File I/O, raw deserialization, and topic filtering (supporting glob patterns like <code>/cam/*</code>).</li>
<li><strong>Error Handling:</strong> It implements configurable policies (<code>IGNORE</code>, <code>LOG_WARN</code>, <code>RAISE</code>) to handle corrupted messages or deserialization failures without crashing the entire pipeline.</li>
</ul>
<h3 id="the-adaptation-layer-rosbridge-adapters">The Adaptation Layer (<code>ROSBridge</code> &amp; Adapters)</h3>
<p>This layer represents the semantic core of the module, translating raw ROS data into the Mosaico Ontology.</p>
<ul>
<li><strong><code>ROSAdapterBase</code>:</strong> An abstract base class that establishes the contract for converting specific ROS message types into their corresponding Mosaico Ontology types.</li>
<li><strong>Concrete Adapters:</strong> The library provides built-in implementations for common standards, such as <code>IMUAdapter</code> (mapping <code>sensor_msgs/Imu</code> to <code>IMU</code>) and <code>ImageAdapter</code> (mapping <code>sensor_msgs/Image</code> to <code>Image</code>). These adapters include advanced logic for recursive unwrapping, automatically extracting data from complex nested wrappers like <code>PoseWithCovarianceStamped</code>. Developers can also implement custom adapters to handle non-standard or proprietary types.</li>
<li><strong><code>ROSBridge</code>:</strong> A central registry and dispatch mechanism that maps ROS message type strings (e.g., <code>sensor_msgs/msg/Imu</code>) to their corresponding adapter classes, ensuring the correct translation logic is applied for each message.</li>
</ul>
<h4 id="extending-the-bridge-custom-adapters">Extending the Bridge (Custom Adapters)</h4>
<p>Users can extend the bridge to support new ROS message types by implementing a custom adapter and registering it.</p>
<ol>
<li><strong>Inherit from <code>ROSAdapterBase</code></strong>: Define the input ROS type string and the target Mosaico Ontology type.</li>
<li><strong>Implement <code>translate</code></strong>: Define the logic to convert the <code>ROSMessage</code> dictionary into a <code>Message</code> object containing the ontology data.</li>
<li><strong>Register</strong>: Decorate the class with <code>@register_adapter</code>.</li>
</ol>
<div class="language-python highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="kn">from</span><span class="w"> </span><span class="nn">mosaicolabs.ros_bridge</span><span class="w"> </span><span class="kn">import</span> <span class="n">ROSAdapterBase</span><span class="p">,</span> <span class="n">register_adapter</span><span class="p">,</span> <span class="n">ROSMessage</span>
</span><span id="__span-0-2"><a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="kn">from</span><span class="w"> </span><span class="nn">mosaicolabs.models</span><span class="w"> </span><span class="kn">import</span> <span class="n">Message</span>
</span><span id="__span-0-3"><a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a><span class="kn">from</span><span class="w"> </span><span class="nn">my_ontology</span><span class="w"> </span><span class="kn">import</span> <span class="n">MyCustomData</span> <span class="c1"># Assuming this class exists</span>
</span><span id="__span-0-4"><a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a>
</span><span id="__span-0-5"><a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a><span class="nd">@register_adapter</span>
</span><span id="__span-0-6"><a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a><span class="k">class</span><span class="w"> </span><span class="nc">MyCustomAdapter</span><span class="p">(</span><span class="n">ROSAdapterBase</span><span class="p">[</span><span class="n">MyCustomData</span><span class="p">]):</span>
</span><span id="__span-0-7"><a id="__codelineno-0-7" name="__codelineno-0-7" href="#__codelineno-0-7"></a>    <span class="n">ros_msgtype</span> <span class="o">=</span> <span class="s2">&quot;my_pkg/msg/MyCustomType&quot;</span>
</span><span id="__span-0-8"><a id="__codelineno-0-8" name="__codelineno-0-8" href="#__codelineno-0-8"></a>    <span class="n">__mosaico_ontology_type__</span> <span class="o">=</span> <span class="n">MyCustomData</span>
</span><span id="__span-0-9"><a id="__codelineno-0-9" name="__codelineno-0-9" href="#__codelineno-0-9"></a>
</span><span id="__span-0-10"><a id="__codelineno-0-10" name="__codelineno-0-10" href="#__codelineno-0-10"></a>    <span class="nd">@classmethod</span>
</span><span id="__span-0-11"><a id="__codelineno-0-11" name="__codelineno-0-11" href="#__codelineno-0-11"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">translate</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">ros_msg</span><span class="p">:</span> <span class="n">ROSMessage</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Message</span><span class="p">:</span>
</span><span id="__span-0-12"><a id="__codelineno-0-12" name="__codelineno-0-12" href="#__codelineno-0-12"></a>        <span class="c1"># Transformation logic here</span>
</span><span id="__span-0-13"><a id="__codelineno-0-13" name="__codelineno-0-13" href="#__codelineno-0-13"></a>        <span class="k">return</span> <span class="n">Message</span><span class="p">(</span>
</span><span id="__span-0-14"><a id="__codelineno-0-14" name="__codelineno-0-14" href="#__codelineno-0-14"></a>            <span class="n">timestamp_ns</span><span class="o">=</span><span class="n">ros_msg</span><span class="o">.</span><span class="n">timestamp</span><span class="p">,</span>
</span><span id="__span-0-15"><a id="__codelineno-0-15" name="__codelineno-0-15" href="#__codelineno-0-15"></a>            <span class="n">data</span><span class="o">=</span><span class="n">MyCustomData</span><span class="p">(</span><span class="o">...</span><span class="p">)</span>
</span><span id="__span-0-16"><a id="__codelineno-0-16" name="__codelineno-0-16" href="#__codelineno-0-16"></a>        <span class="p">)</span>
</span></code></pre></div>
<h3 id="the-orchestrator-rosbaginjector">The Orchestrator (<code>RosbagInjector</code>)</h3>
<p>The <code>RosbagInjector</code> is the primary entry point for embedding ROS ingestion into Python applications and coordinates the entire workflow. It connects the <code>ROSLoader</code> to the <code>MosaicoClient</code>, managing the flow of data, batching, error reporting, and progress visualization via a CLI interface.</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-1-1"><a id="__codelineno-1-1" name="__codelineno-1-1" href="#__codelineno-1-1"></a><span class="k">class</span><span class="w"> </span><span class="nc">RosbagInjector</span><span class="p">:</span>
</span><span id="__span-1-2"><a id="__codelineno-1-2" name="__codelineno-1-2" href="#__codelineno-1-2"></a>    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">config</span><span class="p">:</span> <span class="n">ROSInjectionConfig</span><span class="p">)</span>
</span><span id="__span-1-3"><a id="__codelineno-1-3" name="__codelineno-1-3" href="#__codelineno-1-3"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">run</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
</span></code></pre></div>
<ul>
<li><strong><code>run()</code></strong>: Executes the injection pipeline: connects to the server, opens the bag, iterates through messages, adapts them, and transmits them to the Mosaico platform.</li>
</ul>
<h4 id="rosinjectionconfig"><code>ROSInjectionConfig</code></h4>
<p>A data class defining the configuration for the injection process.</p>
<table>
<thead>
<tr>
<th style="text-align: left;">Attribute</th>
<th style="text-align: left;">Type</th>
<th style="text-align: left;">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left;"><code>file_path</code></td>
<td style="text-align: left;"><code>Path</code></td>
<td style="text-align: left;">Path to the input bag file (<code>.mcap</code>, <code>.db3</code>, <code>.bag</code>).</td>
</tr>
<tr>
<td style="text-align: left;"><code>sequence_name</code></td>
<td style="text-align: left;"><code>str</code></td>
<td style="text-align: left;">The name of the target sequence to create on the server.</td>
</tr>
<tr>
<td style="text-align: left;"><code>metadata</code></td>
<td style="text-align: left;"><code>dict</code></td>
<td style="text-align: left;">User-defined metadata to attach to the sequence (e.g., <code>{"driver": "TestDriver"}</code>).</td>
</tr>
<tr>
<td style="text-align: left;"><code>ros_distro</code></td>
<td style="text-align: left;"><code>Stores</code></td>
<td style="text-align: left;">(Optional) The target ROS distribution (e.g., <code>Stores.ROS2_HUMBLE</code>). Defaults to <code>EMPTY</code>.</td>
</tr>
<tr>
<td style="text-align: left;"><code>topics</code></td>
<td style="text-align: left;"><code>List[str]</code></td>
<td style="text-align: left;">(Optional) A list of topics to filter. Supports glob patterns (e.g., <code>["/cam/*"]</code>).</td>
</tr>
<tr>
<td style="text-align: left;"><code>custom_msgs</code></td>
<td style="text-align: left;"><code>List</code></td>
<td style="text-align: left;">A list of tuples <code>(package, path, store)</code> to register custom <code>.msg</code> definitions.</td>
</tr>
<tr>
<td style="text-align: left;"><code>on_error</code></td>
<td style="text-align: left;"><code>OnErrorPolicy</code></td>
<td style="text-align: left;">Behavior when sequence writing fails (<code>Delete</code> sequence or <code>Report</code> error).</td>
</tr>
</tbody>
</table>
<h4 id="cli-usage">CLI Usage</h4>
<p>The module includes a command-line interface for quick ingestion tasks.</p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-2-1"><a id="__codelineno-2-1" name="__codelineno-2-1" href="#__codelineno-2-1"></a><span class="c1"># Basic Usage</span>
</span><span id="__span-2-2"><a id="__codelineno-2-2" name="__codelineno-2-2" href="#__codelineno-2-2"></a>mosaico.ros_injector<span class="w"> </span>./data.mcap<span class="w"> </span>--name<span class="w"> </span><span class="s2">&quot;Test_Run_01&quot;</span>
</span><span id="__span-2-3"><a id="__codelineno-2-3" name="__codelineno-2-3" href="#__codelineno-2-3"></a>
</span><span id="__span-2-4"><a id="__codelineno-2-4" name="__codelineno-2-4" href="#__codelineno-2-4"></a><span class="c1"># Advanced Usage: Filtering topics and adding metadata</span>
</span><span id="__span-2-5"><a id="__codelineno-2-5" name="__codelineno-2-5" href="#__codelineno-2-5"></a>mosaico.ros_injector<span class="w"> </span>./data.db3<span class="w"> </span><span class="se">\</span>
</span><span id="__span-2-6"><a id="__codelineno-2-6" name="__codelineno-2-6" href="#__codelineno-2-6"></a><span class="w">  </span>--name<span class="w"> </span><span class="s2">&quot;Test_Run_01&quot;</span><span class="w"> </span><span class="se">\</span>
</span><span id="__span-2-7"><a id="__codelineno-2-7" name="__codelineno-2-7" href="#__codelineno-2-7"></a><span class="w">  </span>--topics<span class="w"> </span>/camera/front/*<span class="w"> </span>/gps/fix<span class="w"> </span><span class="se">\</span>
</span><span id="__span-2-8"><a id="__codelineno-2-8" name="__codelineno-2-8" href="#__codelineno-2-8"></a><span class="w">  </span>--metadata<span class="w"> </span>./metadata.json<span class="w"> </span><span class="se">\</span>
</span><span id="__span-2-9"><a id="__codelineno-2-9" name="__codelineno-2-9" href="#__codelineno-2-9"></a><span class="w">  </span>--ros-distro<span class="w"> </span>ros2_humble
</span></code></pre></div>
<p>The full list of options can be retrieved by running <code>mosaico.ros_injector -h</code>:</p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-3-1"><a id="__codelineno-3-1" name="__codelineno-3-1" href="#__codelineno-3-1"></a>usage:<span class="w"> </span>mosaico.ros_injector<span class="w"> </span><span class="o">[</span>-h<span class="o">]</span><span class="w"> </span>--name<span class="w"> </span>NAME<span class="w"> </span><span class="o">[</span>--host<span class="w"> </span>HOST<span class="o">]</span><span class="w"> </span><span class="o">[</span>--port<span class="w"> </span>PORT<span class="o">]</span><span class="w"> </span><span class="o">[</span>--topics<span class="w"> </span>TOPICS<span class="w"> </span><span class="o">[</span>TOPICS<span class="w"> </span>...<span class="o">]]</span><span class="w"> </span><span class="o">[</span>--metadata<span class="w"> </span>METADATA<span class="o">]</span>
</span><span id="__span-3-2"><a id="__codelineno-3-2" name="__codelineno-3-2" href="#__codelineno-3-2"></a><span class="w">                                </span><span class="o">[</span>--ros-distro<span class="w"> </span><span class="o">{</span>empty,latest,ros1_noetic,ros2_dashing,ros2_eloquent,ros2_foxy,ros2_galactic,ros2_humble,ros2_iron,ros2_jazzy,ros2_kilted<span class="o">}]</span>
</span><span id="__span-3-3"><a id="__codelineno-3-3" name="__codelineno-3-3" href="#__codelineno-3-3"></a><span class="w">                                </span>bag_path
</span><span id="__span-3-4"><a id="__codelineno-3-4" name="__codelineno-3-4" href="#__codelineno-3-4"></a>
</span><span id="__span-3-5"><a id="__codelineno-3-5" name="__codelineno-3-5" href="#__codelineno-3-5"></a>Inject<span class="w"> </span>ROS<span class="w"> </span>Bag<span class="w"> </span>data<span class="w"> </span>into<span class="w"> </span>Mosaico.
</span><span id="__span-3-6"><a id="__codelineno-3-6" name="__codelineno-3-6" href="#__codelineno-3-6"></a>
</span><span id="__span-3-7"><a id="__codelineno-3-7" name="__codelineno-3-7" href="#__codelineno-3-7"></a>positional<span class="w"> </span>arguments:
</span><span id="__span-3-8"><a id="__codelineno-3-8" name="__codelineno-3-8" href="#__codelineno-3-8"></a><span class="w">  </span>bag_path<span class="w">              </span>Path<span class="w"> </span>to<span class="w"> </span>.bag,<span class="w"> </span>.mcap<span class="w"> </span>or<span class="w"> </span>.db3<span class="w"> </span>file
</span><span id="__span-3-9"><a id="__codelineno-3-9" name="__codelineno-3-9" href="#__codelineno-3-9"></a>
</span><span id="__span-3-10"><a id="__codelineno-3-10" name="__codelineno-3-10" href="#__codelineno-3-10"></a>options:
</span><span id="__span-3-11"><a id="__codelineno-3-11" name="__codelineno-3-11" href="#__codelineno-3-11"></a><span class="w">  </span>-h,<span class="w"> </span>--help<span class="w">            </span>show<span class="w"> </span>the<span class="w"> </span><span class="nb">help</span><span class="w"> </span>message<span class="w"> </span>and<span class="w"> </span><span class="nb">exit</span>
</span><span id="__span-3-12"><a id="__codelineno-3-12" name="__codelineno-3-12" href="#__codelineno-3-12"></a><span class="w">  </span>--name,<span class="w"> </span>-n<span class="w"> </span>NAME<span class="w">       </span>Target<span class="w"> </span>Sequence<span class="w"> </span>Name
</span><span id="__span-3-13"><a id="__codelineno-3-13" name="__codelineno-3-13" href="#__codelineno-3-13"></a><span class="w">  </span>--host<span class="w"> </span>HOST<span class="w">           </span>Mosaico<span class="w"> </span>Server<span class="w"> </span>Host
</span><span id="__span-3-14"><a id="__codelineno-3-14" name="__codelineno-3-14" href="#__codelineno-3-14"></a><span class="w">  </span>--port<span class="w"> </span>PORT<span class="w">           </span>Mosaico<span class="w"> </span>Server<span class="w"> </span>Port<span class="w"> </span><span class="o">(</span>Default:<span class="w"> </span><span class="m">6726</span><span class="o">)</span>
</span><span id="__span-3-15"><a id="__codelineno-3-15" name="__codelineno-3-15" href="#__codelineno-3-15"></a><span class="w">  </span>--topics<span class="w"> </span>TOPICS<span class="w"> </span><span class="o">[</span>TOPICS<span class="w"> </span>...<span class="o">]</span>
</span><span id="__span-3-16"><a id="__codelineno-3-16" name="__codelineno-3-16" href="#__codelineno-3-16"></a><span class="w">                        </span>Specific<span class="w"> </span>topics<span class="w"> </span>to<span class="w"> </span>filter<span class="w"> </span><span class="o">(</span>supports<span class="w"> </span>glob<span class="w"> </span>patterns<span class="w"> </span>like<span class="w"> </span>/cam/*<span class="o">)</span>
</span><span id="__span-3-17"><a id="__codelineno-3-17" name="__codelineno-3-17" href="#__codelineno-3-17"></a><span class="w">  </span>--metadata<span class="w"> </span>METADATA<span class="w">   </span>JSON<span class="w"> </span>string<span class="w"> </span>or<span class="w"> </span>path<span class="w"> </span>to<span class="w"> </span>JSON<span class="w"> </span>file<span class="w"> </span>containing<span class="w"> </span>sequence<span class="w"> </span>metadata
</span><span id="__span-3-18"><a id="__codelineno-3-18" name="__codelineno-3-18" href="#__codelineno-3-18"></a><span class="w">  </span>--ros-distro<span class="w"> </span><span class="o">{</span>empty,latest,ros1_noetic,ros2_dashing,ros2_eloquent,ros2_foxy,ros2_galactic,ros2_humble,ros2_iron,ros2_jazzy,ros2_kilted<span class="o">}</span>
</span><span id="__span-3-19"><a id="__codelineno-3-19" name="__codelineno-3-19" href="#__codelineno-3-19"></a><span class="w">                        </span>Target<span class="w"> </span>ROS<span class="w"> </span>Distribution<span class="w"> </span><span class="k">for</span><span class="w"> </span>message<span class="w"> </span>parsing<span class="w"> </span><span class="o">(</span>e.g.,<span class="w"> </span>ros2_humble<span class="o">)</span>.<span class="w"> </span>If<span class="w"> </span>not<span class="w"> </span>set,<span class="w"> </span>defaults<span class="w"> </span>to<span class="w"> </span>EMPTY.
</span></code></pre></div>
<h4 id="programmatic-usage-python-script">Programmatic Usage (Python Script)</h4>
<p>For code-first workflows, such as integrating with CI/CD or custom automation scripts, it is possible to use the <code>RosbagInjector</code> class directly within Python code.</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-4-1"><a id="__codelineno-4-1" name="__codelineno-4-1" href="#__codelineno-4-1"></a><span class="kn">from</span><span class="w"> </span><span class="nn">pathlib</span><span class="w"> </span><span class="kn">import</span> <span class="n">Path</span>
</span><span id="__span-4-2"><a id="__codelineno-4-2" name="__codelineno-4-2" href="#__codelineno-4-2"></a><span class="kn">from</span><span class="w"> </span><span class="nn">mosaicolabs.ros_bridge</span><span class="w"> </span><span class="kn">import</span> <span class="n">RosbagInjector</span><span class="p">,</span> <span class="n">ROSInjectionConfig</span><span class="p">,</span> <span class="n">Stores</span>
</span><span id="__span-4-3"><a id="__codelineno-4-3" name="__codelineno-4-3" href="#__codelineno-4-3"></a>
</span><span id="__span-4-4"><a id="__codelineno-4-4" name="__codelineno-4-4" href="#__codelineno-4-4"></a><span class="k">def</span><span class="w"> </span><span class="nf">run_injection</span><span class="p">():</span>
</span><span id="__span-4-5"><a id="__codelineno-4-5" name="__codelineno-4-5" href="#__codelineno-4-5"></a>    <span class="c1"># Define the Injection Configuration</span>
</span><span id="__span-4-6"><a id="__codelineno-4-6" name="__codelineno-4-6" href="#__codelineno-4-6"></a>    <span class="c1"># This data class acts as the single source for the operation.</span>
</span><span id="__span-4-7"><a id="__codelineno-4-7" name="__codelineno-4-7" href="#__codelineno-4-7"></a>    <span class="n">config</span> <span class="o">=</span> <span class="n">ROSInjectionConfig</span><span class="p">(</span>
</span><span id="__span-4-8"><a id="__codelineno-4-8" name="__codelineno-4-8" href="#__codelineno-4-8"></a>        <span class="c1"># Input Data</span>
</span><span id="__span-4-9"><a id="__codelineno-4-9" name="__codelineno-4-9" href="#__codelineno-4-9"></a>        <span class="n">file_path</span><span class="o">=</span><span class="n">Path</span><span class="p">(</span><span class="s2">&quot;data/session_01.db3&quot;</span><span class="p">),</span>
</span><span id="__span-4-10"><a id="__codelineno-4-10" name="__codelineno-4-10" href="#__codelineno-4-10"></a>
</span><span id="__span-4-11"><a id="__codelineno-4-11" name="__codelineno-4-11" href="#__codelineno-4-11"></a>        <span class="c1"># Target Platform Metadata</span>
</span><span id="__span-4-12"><a id="__codelineno-4-12" name="__codelineno-4-12" href="#__codelineno-4-12"></a>        <span class="n">sequence_name</span><span class="o">=</span><span class="s2">&quot;test_ros_sequence&quot;</span><span class="p">,</span>
</span><span id="__span-4-13"><a id="__codelineno-4-13" name="__codelineno-4-13" href="#__codelineno-4-13"></a>        <span class="n">metadata</span><span class="o">=</span><span class="p">{</span>
</span><span id="__span-4-14"><a id="__codelineno-4-14" name="__codelineno-4-14" href="#__codelineno-4-14"></a>            <span class="s2">&quot;driver_version&quot;</span><span class="p">:</span> <span class="s2">&quot;v2.1&quot;</span><span class="p">,</span> 
</span><span id="__span-4-15"><a id="__codelineno-4-15" name="__codelineno-4-15" href="#__codelineno-4-15"></a>            <span class="s2">&quot;weather&quot;</span><span class="p">:</span> <span class="s2">&quot;sunny&quot;</span><span class="p">,</span>
</span><span id="__span-4-16"><a id="__codelineno-4-16" name="__codelineno-4-16" href="#__codelineno-4-16"></a>            <span class="s2">&quot;location&quot;</span><span class="p">:</span> <span class="s2">&quot;test_track_A&quot;</span>
</span><span id="__span-4-17"><a id="__codelineno-4-17" name="__codelineno-4-17" href="#__codelineno-4-17"></a>        <span class="p">},</span>
</span><span id="__span-4-18"><a id="__codelineno-4-18" name="__codelineno-4-18" href="#__codelineno-4-18"></a>
</span><span id="__span-4-19"><a id="__codelineno-4-19" name="__codelineno-4-19" href="#__codelineno-4-19"></a>        <span class="c1"># Topic Filtering (supports glob patterns)</span>
</span><span id="__span-4-20"><a id="__codelineno-4-20" name="__codelineno-4-20" href="#__codelineno-4-20"></a>        <span class="c1"># This will only upload topics starting with &#39;/cam&#39;</span>
</span><span id="__span-4-21"><a id="__codelineno-4-21" name="__codelineno-4-21" href="#__codelineno-4-21"></a>        <span class="n">topics</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;/cam*&quot;</span><span class="p">],</span>
</span><span id="__span-4-22"><a id="__codelineno-4-22" name="__codelineno-4-22" href="#__codelineno-4-22"></a>
</span><span id="__span-4-23"><a id="__codelineno-4-23" name="__codelineno-4-23" href="#__codelineno-4-23"></a>        <span class="c1"># ROS Configuration</span>
</span><span id="__span-4-24"><a id="__codelineno-4-24" name="__codelineno-4-24" href="#__codelineno-4-24"></a>        <span class="c1"># Specifying the distro ensures correct parsing of standard messages</span>
</span><span id="__span-4-25"><a id="__codelineno-4-25" name="__codelineno-4-25" href="#__codelineno-4-25"></a>        <span class="c1"># (.db3 sqlite3 rosbags need the specification of distro)</span>
</span><span id="__span-4-26"><a id="__codelineno-4-26" name="__codelineno-4-26" href="#__codelineno-4-26"></a>        <span class="n">ros_distro</span><span class="o">=</span><span class="n">Stores</span><span class="o">.</span><span class="n">ROS2_HUMBLE</span><span class="p">,</span>
</span><span id="__span-4-27"><a id="__codelineno-4-27" name="__codelineno-4-27" href="#__codelineno-4-27"></a>
</span><span id="__span-4-28"><a id="__codelineno-4-28" name="__codelineno-4-28" href="#__codelineno-4-28"></a>        <span class="c1"># Custom Message Registration</span>
</span><span id="__span-4-29"><a id="__codelineno-4-29" name="__codelineno-4-29" href="#__codelineno-4-29"></a>        <span class="c1"># Register proprietary messages before loading to prevent errors</span>
</span><span id="__span-4-30"><a id="__codelineno-4-30" name="__codelineno-4-30" href="#__codelineno-4-30"></a>        <span class="n">custom_msgs</span><span class="o">=</span><span class="p">[</span>
</span><span id="__span-4-31"><a id="__codelineno-4-31" name="__codelineno-4-31" href="#__codelineno-4-31"></a>            <span class="p">(</span>
</span><span id="__span-4-32"><a id="__codelineno-4-32" name="__codelineno-4-32" href="#__codelineno-4-32"></a>                <span class="s2">&quot;my_custom_pkg&quot;</span><span class="p">,</span>                 <span class="c1"># ROS Package Name</span>
</span><span id="__span-4-33"><a id="__codelineno-4-33" name="__codelineno-4-33" href="#__codelineno-4-33"></a>                <span class="n">Path</span><span class="p">(</span><span class="s2">&quot;./definitions/my_pkg/&quot;</span><span class="p">),</span>   <span class="c1"># Path to directory containing .msg files</span>
</span><span id="__span-4-34"><a id="__codelineno-4-34" name="__codelineno-4-34" href="#__codelineno-4-34"></a>                <span class="n">Stores</span><span class="o">.</span><span class="n">ROS2_HUMBLE</span><span class="p">,</span>              <span class="c1"># Scope (valid for this distro)</span>
</span><span id="__span-4-35"><a id="__codelineno-4-35" name="__codelineno-4-35" href="#__codelineno-4-35"></a>            <span class="p">)</span> <span class="c1"># registry will automatically infer type names as `my_custom_pkg/msg/{filename}`</span>
</span><span id="__span-4-36"><a id="__codelineno-4-36" name="__codelineno-4-36" href="#__codelineno-4-36"></a>        <span class="p">],</span>
</span><span id="__span-4-37"><a id="__codelineno-4-37" name="__codelineno-4-37" href="#__codelineno-4-37"></a>
</span><span id="__span-4-38"><a id="__codelineno-4-38" name="__codelineno-4-38" href="#__codelineno-4-38"></a>        <span class="c1"># Execution Settings</span>
</span><span id="__span-4-39"><a id="__codelineno-4-39" name="__codelineno-4-39" href="#__codelineno-4-39"></a>        <span class="n">log_level</span><span class="o">=</span><span class="s2">&quot;WARNING&quot;</span><span class="p">,</span>  <span class="c1"># Reduce verbosity for automated scripts</span>
</span><span id="__span-4-40"><a id="__codelineno-4-40" name="__codelineno-4-40" href="#__codelineno-4-40"></a>    <span class="p">)</span>
</span><span id="__span-4-41"><a id="__codelineno-4-41" name="__codelineno-4-41" href="#__codelineno-4-41"></a>
</span><span id="__span-4-42"><a id="__codelineno-4-42" name="__codelineno-4-42" href="#__codelineno-4-42"></a>    <span class="c1"># Instantiate the Controller</span>
</span><span id="__span-4-43"><a id="__codelineno-4-43" name="__codelineno-4-43" href="#__codelineno-4-43"></a>    <span class="n">injector</span> <span class="o">=</span> <span class="n">RosbagInjector</span><span class="p">(</span><span class="n">config</span><span class="p">)</span>
</span><span id="__span-4-44"><a id="__codelineno-4-44" name="__codelineno-4-44" href="#__codelineno-4-44"></a>
</span><span id="__span-4-45"><a id="__codelineno-4-45" name="__codelineno-4-45" href="#__codelineno-4-45"></a>    <span class="c1"># Execute</span>
</span><span id="__span-4-46"><a id="__codelineno-4-46" name="__codelineno-4-46" href="#__codelineno-4-46"></a>    <span class="c1"># The run method handles connection, loading, and uploading automatically.</span>
</span><span id="__span-4-47"><a id="__codelineno-4-47" name="__codelineno-4-47" href="#__codelineno-4-47"></a>    <span class="c1"># It raises exceptions for fatal errors, allowing you to wrap it in try/except blocks.</span>
</span><span id="__span-4-48"><a id="__codelineno-4-48" name="__codelineno-4-48" href="#__codelineno-4-48"></a>    <span class="k">try</span><span class="p">:</span>
</span><span id="__span-4-49"><a id="__codelineno-4-49" name="__codelineno-4-49" href="#__codelineno-4-49"></a>        <span class="n">injector</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
</span><span id="__span-4-50"><a id="__codelineno-4-50" name="__codelineno-4-50" href="#__codelineno-4-50"></a>        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Injection job completed successfully.&quot;</span><span class="p">)</span>
</span><span id="__span-4-51"><a id="__codelineno-4-51" name="__codelineno-4-51" href="#__codelineno-4-51"></a>    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
</span><span id="__span-4-52"><a id="__codelineno-4-52" name="__codelineno-4-52" href="#__codelineno-4-52"></a>        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Injection job failed: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="__span-4-53"><a id="__codelineno-4-53" name="__codelineno-4-53" href="#__codelineno-4-53"></a>
</span><span id="__span-4-54"><a id="__codelineno-4-54" name="__codelineno-4-54" href="#__codelineno-4-54"></a><span class="c1"># Use as script or call the injection function in your code</span>
</span><span id="__span-4-55"><a id="__codelineno-4-55" name="__codelineno-4-55" href="#__codelineno-4-55"></a><span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>
</span><span id="__span-4-56"><a id="__codelineno-4-56" name="__codelineno-4-56" href="#__codelineno-4-56"></a>    <span class="n">run_injection</span><span class="p">()</span>
</span></code></pre></div>
<h3 id="the-type-registry-rostyperegistry">The Type Registry (<code>ROSTypeRegistry</code>)</h3>
<p>ROS message definitions are not always self-contained within bag files (particularly in the ROS 2 <code>.db3</code> format), and datasets often contain proprietary data types that are not part of the standard message libraries. These definitions rely on external schema files (<code>.msg</code>). The <code>ROSTypeRegistry</code> acts as a context-aware singleton to manage these dependencies.</p>
<ul>
<li><strong>Custom Messages:</strong> It facilitates the registration of local <code>.msg</code> files, allowing the loader to parse proprietary or non-standard message types effectively.</li>
<li><strong>Versioning:</strong> It implements a profile system (Stores) to resolve version conflicts, managing cases where message definitions differ between distributions (e.g., <code>ROS1_NOETIC</code> vs. <code>ROS2_HUMBLE</code>).</li>
</ul>
<p>For complex projects with many custom message definitions, passing them repeatedly via the <code>custom_msgs</code> argument of the <code>ROSInjectionConfig</code> class can become unwieldy. Instead, you can use the <strong><code>ROSTypeRegistry</code></strong> to pre-load definitions at the start of your application.</p>
<ul>
<li><strong><code>register_directory(package_name, dir_path, store=None)</code></strong>: Batch registers all <code>.msg</code> files found in a directory under a specific package name. The registry will automatically infer type names as <code>{package_name}/msg/{filename}</code></li>
<li><strong><code>register(msg_type, source, store=None)</code></strong>: Registers a single message type definition.</li>
</ul>
<h4 id="centralized-custom-message-registration">Centralized Custom Message Registration</h4>
<p>For example, create a setup script (e.g., <code>setup_registry.py</code>) that runs before your injection logic.</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-5-1"><a id="__codelineno-5-1" name="__codelineno-5-1" href="#__codelineno-5-1"></a><span class="kn">from</span><span class="w"> </span><span class="nn">pathlib</span><span class="w"> </span><span class="kn">import</span> <span class="n">Path</span>
</span><span id="__span-5-2"><a id="__codelineno-5-2" name="__codelineno-5-2" href="#__codelineno-5-2"></a><span class="kn">from</span><span class="w"> </span><span class="nn">mosaicolabs.ros_bridge</span><span class="w"> </span><span class="kn">import</span> <span class="n">ROSTypeRegistry</span><span class="p">,</span> <span class="n">Stores</span>
</span><span id="__span-5-3"><a id="__codelineno-5-3" name="__codelineno-5-3" href="#__codelineno-5-3"></a>
</span><span id="__span-5-4"><a id="__codelineno-5-4" name="__codelineno-5-4" href="#__codelineno-5-4"></a><span class="k">def</span><span class="w"> </span><span class="nf">register_project_messages</span><span class="p">():</span>
</span><span id="__span-5-5"><a id="__codelineno-5-5" name="__codelineno-5-5" href="#__codelineno-5-5"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="__span-5-6"><a id="__codelineno-5-6" name="__codelineno-5-6" href="#__codelineno-5-6"></a><span class="sd">    Centralized registration of all custom ROS message definitions used in the project.</span>
</span><span id="__span-5-7"><a id="__codelineno-5-7" name="__codelineno-5-7" href="#__codelineno-5-7"></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="__span-5-8"><a id="__codelineno-5-8" name="__codelineno-5-8" href="#__codelineno-5-8"></a>
</span><span id="__span-5-9"><a id="__codelineno-5-9" name="__codelineno-5-9" href="#__codelineno-5-9"></a>    <span class="c1"># Register a Single Message Globally (Applies to all ROS versions)</span>
</span><span id="__span-5-10"><a id="__codelineno-5-10" name="__codelineno-5-10" href="#__codelineno-5-10"></a>    <span class="c1"># Useful for simple, stable message definitions.</span>
</span><span id="__span-5-11"><a id="__codelineno-5-11" name="__codelineno-5-11" href="#__codelineno-5-11"></a>    <span class="n">ROSTypeRegistry</span><span class="o">.</span><span class="n">register</span><span class="p">(</span>
</span><span id="__span-5-12"><a id="__codelineno-5-12" name="__codelineno-5-12" href="#__codelineno-5-12"></a>        <span class="n">msg_type</span><span class="o">=</span><span class="s2">&quot;my_robot_msgs/msg/BatteryStatus&quot;</span><span class="p">,</span>
</span><span id="__span-5-13"><a id="__codelineno-5-13" name="__codelineno-5-13" href="#__codelineno-5-13"></a>        <span class="n">source</span><span class="o">=</span><span class="n">Path</span><span class="p">(</span><span class="s2">&quot;./definitions/common/BatteryStatus.msg&quot;</span><span class="p">)</span>
</span><span id="__span-5-14"><a id="__codelineno-5-14" name="__codelineno-5-14" href="#__codelineno-5-14"></a>    <span class="p">)</span>
</span><span id="__span-5-15"><a id="__codelineno-5-15" name="__codelineno-5-15" href="#__codelineno-5-15"></a>
</span><span id="__span-5-16"><a id="__codelineno-5-16" name="__codelineno-5-16" href="#__codelineno-5-16"></a>    <span class="c1"># Register for a Specific Distro (e.g., ROS 2 Humble)</span>
</span><span id="__span-5-17"><a id="__codelineno-5-17" name="__codelineno-5-17" href="#__codelineno-5-17"></a>    <span class="c1"># Essential if the definition changed between versions or relies on specific headers.</span>
</span><span id="__span-5-18"><a id="__codelineno-5-18" name="__codelineno-5-18" href="#__codelineno-5-18"></a>    <span class="n">ROSTypeRegistry</span><span class="o">.</span><span class="n">register</span><span class="p">(</span>
</span><span id="__span-5-19"><a id="__codelineno-5-19" name="__codelineno-5-19" href="#__codelineno-5-19"></a>        <span class="n">msg_type</span><span class="o">=</span><span class="s2">&quot;my_robot_msgs/msg/NavigationState&quot;</span><span class="p">,</span>
</span><span id="__span-5-20"><a id="__codelineno-5-20" name="__codelineno-5-20" href="#__codelineno-5-20"></a>        <span class="n">source</span><span class="o">=</span><span class="n">Path</span><span class="p">(</span><span class="s2">&quot;./definitions/humble/NavigationState.msg&quot;</span><span class="p">),</span>
</span><span id="__span-5-21"><a id="__codelineno-5-21" name="__codelineno-5-21" href="#__codelineno-5-21"></a>        <span class="n">store</span><span class="o">=</span><span class="n">Stores</span><span class="o">.</span><span class="n">ROS2_HUMBLE</span>
</span><span id="__span-5-22"><a id="__codelineno-5-22" name="__codelineno-5-22" href="#__codelineno-5-22"></a>    <span class="p">)</span>
</span><span id="__span-5-23"><a id="__codelineno-5-23" name="__codelineno-5-23" href="#__codelineno-5-23"></a>
</span><span id="__span-5-24"><a id="__codelineno-5-24" name="__codelineno-5-24" href="#__codelineno-5-24"></a>    <span class="c1"># Batch Register an Entire Directory</span>
</span><span id="__span-5-25"><a id="__codelineno-5-25" name="__codelineno-5-25" href="#__codelineno-5-25"></a>    <span class="c1"># Automatically infers type names: &quot;package_name/msg/{filename}&quot;</span>
</span><span id="__span-5-26"><a id="__codelineno-5-26" name="__codelineno-5-26" href="#__codelineno-5-26"></a>    <span class="c1"># Example: ./definitions/lidar/Scan.msg -&gt; &quot;velodyne_msgs/msg/Scan&quot;</span>
</span><span id="__span-5-27"><a id="__codelineno-5-27" name="__codelineno-5-27" href="#__codelineno-5-27"></a>    <span class="n">ROSTypeRegistry</span><span class="o">.</span><span class="n">register_directory</span><span class="p">(</span>
</span><span id="__span-5-28"><a id="__codelineno-5-28" name="__codelineno-5-28" href="#__codelineno-5-28"></a>        <span class="n">package_name</span><span class="o">=</span><span class="s2">&quot;velodyne_msgs&quot;</span><span class="p">,</span>
</span><span id="__span-5-29"><a id="__codelineno-5-29" name="__codelineno-5-29" href="#__codelineno-5-29"></a>        <span class="n">dir_path</span><span class="o">=</span><span class="n">Path</span><span class="p">(</span><span class="s2">&quot;./definitions/lidar&quot;</span><span class="p">),</span>
</span><span id="__span-5-30"><a id="__codelineno-5-30" name="__codelineno-5-30" href="#__codelineno-5-30"></a>        <span class="n">store</span><span class="o">=</span><span class="n">Stores</span><span class="o">.</span><span class="n">ROS2_HUMBLE</span>
</span><span id="__span-5-31"><a id="__codelineno-5-31" name="__codelineno-5-31" href="#__codelineno-5-31"></a>    <span class="p">)</span>
</span><span id="__span-5-32"><a id="__codelineno-5-32" name="__codelineno-5-32" href="#__codelineno-5-32"></a>
</span><span id="__span-5-33"><a id="__codelineno-5-33" name="__codelineno-5-33" href="#__codelineno-5-33"></a>    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Custom message definitions registered successfully.&quot;</span><span class="p">)</span>
</span></code></pre></div>
<p>Once registered, the <code>RosbagInjector</code> (and the underlying <code>ROSLoader</code>) automatically detects and uses these definitions. There is no longer the need to pass the <code>custom_msgs</code> list in the <code>ROSInjectionConfig</code>.</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-6-1"><a id="__codelineno-6-1" name="__codelineno-6-1" href="#__codelineno-6-1"></a><span class="c1"># main_injection.py</span>
</span><span id="__span-6-2"><a id="__codelineno-6-2" name="__codelineno-6-2" href="#__codelineno-6-2"></a><span class="kn">import</span><span class="w"> </span><span class="nn">setup_registry</span>  <span class="c1"># Runs the registration logic above</span>
</span><span id="__span-6-3"><a id="__codelineno-6-3" name="__codelineno-6-3" href="#__codelineno-6-3"></a><span class="kn">from</span><span class="w"> </span><span class="nn">mosaicolabs.ros_bridge</span><span class="w"> </span><span class="kn">import</span> <span class="n">RosbagInjector</span><span class="p">,</span> <span class="n">ROSInjectionConfig</span><span class="p">,</span> <span class="n">Stores</span>
</span><span id="__span-6-4"><a id="__codelineno-6-4" name="__codelineno-6-4" href="#__codelineno-6-4"></a><span class="kn">from</span><span class="w"> </span><span class="nn">pathlib</span><span class="w"> </span><span class="kn">import</span> <span class="n">Path</span>
</span><span id="__span-6-5"><a id="__codelineno-6-5" name="__codelineno-6-5" href="#__codelineno-6-5"></a>
</span><span id="__span-6-6"><a id="__codelineno-6-6" name="__codelineno-6-6" href="#__codelineno-6-6"></a><span class="c1"># Initialize registry</span>
</span><span id="__span-6-7"><a id="__codelineno-6-7" name="__codelineno-6-7" href="#__codelineno-6-7"></a><span class="n">setup_registry</span><span class="o">.</span><span class="n">register_project_messages</span><span class="p">()</span>
</span><span id="__span-6-8"><a id="__codelineno-6-8" name="__codelineno-6-8" href="#__codelineno-6-8"></a>
</span><span id="__span-6-9"><a id="__codelineno-6-9" name="__codelineno-6-9" href="#__codelineno-6-9"></a><span class="c1"># Configure injection WITHOUT listing custom messages again</span>
</span><span id="__span-6-10"><a id="__codelineno-6-10" name="__codelineno-6-10" href="#__codelineno-6-10"></a><span class="n">config</span> <span class="o">=</span> <span class="n">ROSInjectionConfig</span><span class="p">(</span>
</span><span id="__span-6-11"><a id="__codelineno-6-11" name="__codelineno-6-11" href="#__codelineno-6-11"></a>    <span class="n">file_path</span><span class="o">=</span><span class="n">Path</span><span class="p">(</span><span class="s2">&quot;mission_data.mcap&quot;</span><span class="p">),</span>
</span><span id="__span-6-12"><a id="__codelineno-6-12" name="__codelineno-6-12" href="#__codelineno-6-12"></a>    <span class="n">sequence_name</span><span class="o">=</span><span class="s2">&quot;mission_01&quot;</span><span class="p">,</span>
</span><span id="__span-6-13"><a id="__codelineno-6-13" name="__codelineno-6-13" href="#__codelineno-6-13"></a>    <span class="n">metadata</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;operator&quot;</span><span class="p">:</span> <span class="s2">&quot;Alice&quot;</span><span class="p">},</span>
</span><span id="__span-6-14"><a id="__codelineno-6-14" name="__codelineno-6-14" href="#__codelineno-6-14"></a>    <span class="n">ros_distro</span><span class="o">=</span><span class="n">Stores</span><span class="o">.</span><span class="n">ROS2_HUMBLE</span><span class="p">,</span>  <span class="c1"># Loader will pull the Humble-specific types we registered</span>
</span><span id="__span-6-15"><a id="__codelineno-6-15" name="__codelineno-6-15" href="#__codelineno-6-15"></a>    <span class="c1"># custom_msgs=[]  &lt;-- No longer needed!</span>
</span><span id="__span-6-16"><a id="__codelineno-6-16" name="__codelineno-6-16" href="#__codelineno-6-16"></a><span class="p">)</span>
</span><span id="__span-6-17"><a id="__codelineno-6-17" name="__codelineno-6-17" href="#__codelineno-6-17"></a>
</span><span id="__span-6-18"><a id="__codelineno-6-18" name="__codelineno-6-18" href="#__codelineno-6-18"></a><span class="n">injector</span> <span class="o">=</span> <span class="n">RosbagInjector</span><span class="p">(</span><span class="n">config</span><span class="p">)</span>
</span><span id="__span-6-19"><a id="__codelineno-6-19" name="__codelineno-6-19" href="#__codelineno-6-19"></a><span class="n">injector</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
</span></code></pre></div>
<h3 id="testing-validation">Testing &amp; Validation</h3>
<p>The ROS Bag Injection module has been validated against a variety of standard datasets to ensure compatibility with different ROS distributions, message serialization formats (CDR/ROS 1), and bag container formats (<code>.bag</code>, <code>.mcap</code>, <code>.db3</code>).</p>
<h4 id="recommended-dataset-for-verification">Recommended Dataset for Verification</h4>
<p>For evaluating Mosaico capabilities, we recommend the <strong><a href="https://catalog.ngc.nvidia.com/orgs/nvidia/teams/isaac/resources/r2bdataset2024?version=1">NVIDIA NGC Catalog - R2B Dataset 2024</a></strong>. This dataset has been verified to be fully compatible with the injection pipeline.</p>
<p>The following table summarizes the injection performance for key sequences within this dataset:</p>
<table>
<thead>
<tr>
<th style="text-align: left;">Sequence Name</th>
<th style="text-align: left;">Compression Factor</th>
<th style="text-align: left;">Injection Time</th>
<th style="text-align: left;">Notes</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left;"><strong><code>r2b_galileo2</code></strong></td>
<td style="text-align: left;">~70%</td>
<td style="text-align: left;">~40 sec</td>
<td style="text-align: left;">High compression achieved.</td>
</tr>
<tr>
<td style="text-align: left;"><strong><code>r2b_galileo</code></strong></td>
<td style="text-align: left;">~1%</td>
<td style="text-align: left;">~20 sec</td>
<td style="text-align: left;"><strong>Low Compression:</strong> Source contains pre-compressed images. <br> <strong>Skipped Topics:</strong> <code>/chassis/ticks</code> (No adapter available).</td>
</tr>
<tr>
<td style="text-align: left;"><strong><code>r2b_robotarm</code></strong></td>
<td style="text-align: left;">~66%</td>
<td style="text-align: left;">~50 sec</td>
<td style="text-align: left;">High compression achieved.</td>
</tr>
<tr>
<td style="text-align: left;"><strong><code>r2b_whitetunnel</code></strong></td>
<td style="text-align: left;">~1%</td>
<td style="text-align: left;">~20 sec</td>
<td style="text-align: left;"><strong>Low Compression:</strong> Source contains pre-compressed images. <br> <strong>Skipped Topics:</strong> <code>/chassis/ticks</code> (No adapter available).</td>
</tr>
</tbody>
</table>
<h4 id="known-issues-limitations">Known Issues &amp; Limitations</h4>
<p>While the underlying <code>rosbags</code> library supports the majority of standard ROS 2 bag files, specific datasets with non-standard serialization alignment or proprietary encodings may encounter compatibility issues.</p>
<p><strong>NVIDIA Isaac ROS Benchmark Dataset (2023)</strong></p>
<ul>
<li><strong>Source:</strong> <a href="https://catalog.ngc.nvidia.com/orgs/nvidia/teams/isaac/resources/r2bdataset2023">NVIDIA NGC Catalog - R2B Dataset 2023</a></li>
<li><strong>Issue:</strong> Deserialization failure during ingestion.</li>
<li><strong>Technical Details:</strong> The ingestion process fails within the <code>AnyReader.deserialize</code> method of the <code>rosbags</code> library. The internal CDR deserializer triggers an assertion error indicating a mismatch in the expected data length vs. the raw payload size.</li>
<li><strong>Error Signature:</strong>
    <div class="language-python highlight"><pre><span></span><code><span id="__span-7-1"><a id="__codelineno-7-1" name="__codelineno-7-1" href="#__codelineno-7-1"></a><span class="c1"># In rosbags.serde.cdr:</span>
</span><span id="__span-7-2"><a id="__codelineno-7-2" name="__codelineno-7-2" href="#__codelineno-7-2"></a><span class="k">assert</span> <span class="n">pos</span> <span class="o">+</span> <span class="mi">4</span> <span class="o">+</span> <span class="mi">3</span> <span class="o">&gt;=</span> <span class="nb">len</span><span class="p">(</span><span class="n">rawdata</span><span class="p">)</span>
</span></code></pre></div></li>
<li><strong>Recommendation:</strong> This issue originates in the upstream <code>rosbags</code> parser handling of this specific dataset's serialization alignment. It is currently recommended to exclude this dataset or transcode it using standard ROS 2 tools before ingestion.</li>
</ul>
<h2 id="supported-message-types">Supported Message Types</h2>
<p><strong><em>ROS-Specific Data Models</em></strong></p>
<p>In addition to mapping standard ROS messages to the core Mosaico ontology, the <code>ros-bridge</code> module implements two specialized data models. These are defined specifically for this module to handle ROS-native concepts that are not yet part of the official Mosaico standard:</p>
<ul>
<li><strong><code>FrameTransform</code></strong>: Designed to handle coordinate frame transformations (modeled after <code>tf2_msgs/msg/TFMessage</code>). It encapsulates a list of <code>Transform</code> objects to manage spatial relationships.</li>
<li><strong><code>BatteryState</code></strong>: Modeled after <code>sensor_msgs/msg/BatteryState</code>, this class captures comprehensive power supply metrics. It includes core data (voltage, current, capacity, percentage) and detailed metadata such as power supply health, technology status, and individual cell readings.</li>
</ul>
<blockquote>
<p><strong>Note:</strong> Although these are provisional additions, both <code>FrameTransform</code> and <code>BatteryState</code> inherit from <code>Serializable</code> and <code>HeaderMixin</code>. This ensures they remain fully compatible with Mosaicoâ€™s existing serialization and header management infrastructure.</p>
</blockquote>
<h3 id="supported-message-types-table">Supported Message Types Table</h3>
<table>
<thead>
<tr>
<th style="text-align: left;">ROS Message Type</th>
<th style="text-align: left;">Mosaico Ontology Type</th>
<th style="text-align: left;">Adapter</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left;"><code>geometry_msgs/Pose</code>, <code>PoseStamped</code>...</td>
<td style="text-align: left;"><code>Pose</code></td>
<td style="text-align: left;"><code>PoseAdapter</code></td>
</tr>
<tr>
<td style="text-align: left;"><code>geometry_msgs/Twist</code>, <code>TwistStamped</code>...</td>
<td style="text-align: left;"><code>Velocity</code></td>
<td style="text-align: left;"><code>TwistAdapter</code></td>
</tr>
<tr>
<td style="text-align: left;"><code>geometry_msgs/Accel</code>, <code>AccelStamped</code>...</td>
<td style="text-align: left;"><code>Acceleration</code></td>
<td style="text-align: left;"><code>AccelAdapter</code></td>
</tr>
<tr>
<td style="text-align: left;"><code>geometry_msgs/Vector3</code>, <code>Vector3Stamped</code></td>
<td style="text-align: left;"><code>Vector3d</code></td>
<td style="text-align: left;"><code>Vector3Adapter</code></td>
</tr>
<tr>
<td style="text-align: left;"><code>geometry_msgs/Point</code>, <code>PointStamped</code></td>
<td style="text-align: left;"><code>Point3d</code></td>
<td style="text-align: left;"><code>PointAdapter</code></td>
</tr>
<tr>
<td style="text-align: left;"><code>geometry_msgs/Quaternion</code>, <code>QuaternionStamped</code></td>
<td style="text-align: left;"><code>Quaternion</code></td>
<td style="text-align: left;"><code>QuaternionAdapter</code></td>
</tr>
<tr>
<td style="text-align: left;"><code>geometry_msgs/Transform</code>, <code>TransformStamped</code></td>
<td style="text-align: left;"><code>Transform</code></td>
<td style="text-align: left;"><code>TransformAdapter</code></td>
</tr>
<tr>
<td style="text-align: left;"><code>geometry_msgs/Wrench</code>, <code>WrenchStamped</code></td>
<td style="text-align: left;"><code>Velocity</code></td>
<td style="text-align: left;"><code>WrenchAdapter</code></td>
</tr>
<tr>
<td style="text-align: left;"><code>nav_msgs/Odometry</code></td>
<td style="text-align: left;"><code>MotionState</code></td>
<td style="text-align: left;"><code>OdometryAdapter</code></td>
</tr>
<tr>
<td style="text-align: left;"><code>nmea_msgs/Sentence</code></td>
<td style="text-align: left;"><code>NMEASentence</code></td>
<td style="text-align: left;"><code>NMEASentenceAdapter</code></td>
</tr>
<tr>
<td style="text-align: left;"><code>sensor_msgs/Image</code>, <code>CompressedImage</code></td>
<td style="text-align: left;"><code>Image</code>, <code>CompressedImage</code></td>
<td style="text-align: left;"><code>ImageAdapter</code>, <code>CompressedImageAdapter</code></td>
</tr>
<tr>
<td style="text-align: left;"><code>sensor_msgs/Imu</code></td>
<td style="text-align: left;"><code>IMU</code></td>
<td style="text-align: left;"><code>IMUAdapter</code></td>
</tr>
<tr>
<td style="text-align: left;"><code>sensor_msgs/NavSatFix</code></td>
<td style="text-align: left;"><code>GPS</code>, <code>GPSStatus</code></td>
<td style="text-align: left;"><code>GPSAdapter</code>, <code>NavSatStatusAdapter</code></td>
</tr>
<tr>
<td style="text-align: left;"><code>sensor_msgs/CameraInfo</code></td>
<td style="text-align: left;"><code>CameraInfo</code></td>
<td style="text-align: left;"><code>CameraInfoAdapter</code></td>
</tr>
<tr>
<td style="text-align: left;"><code>sensor_msgs/RegionOfInterest</code></td>
<td style="text-align: left;"><code>ROI</code></td>
<td style="text-align: left;"><code>ROIAdapter</code></td>
</tr>
<tr>
<td style="text-align: left;"><code>sensor_msgs/JointState</code></td>
<td style="text-align: left;"><code>RobotJoint</code></td>
<td style="text-align: left;"><code>RobotJointAdapter</code></td>
</tr>
<tr>
<td style="text-align: left;"><code>sensor_msgs/BatteryState</code></td>
<td style="text-align: left;"><code>BatteryState</code> (ROS-specific)</td>
<td style="text-align: left;"><code>BatteryStateAdapter</code></td>
</tr>
<tr>
<td style="text-align: left;"><code>std_msgs/msg/String</code></td>
<td style="text-align: left;"><code>String</code></td>
<td style="text-align: left;"><code>_GenericStdAdapter</code></td>
</tr>
<tr>
<td style="text-align: left;"><code>std_msgs/msg/Int8(16,32,64)</code></td>
<td style="text-align: left;"><code>Integer8(16,32,64)</code></td>
<td style="text-align: left;"><code>_GenericStdAdapter</code></td>
</tr>
<tr>
<td style="text-align: left;"><code>std_msgs/msg/UInt8(16,32,64)</code></td>
<td style="text-align: left;"><code>Unsigned8(16,32,64)</code></td>
<td style="text-align: left;"><code>_GenericStdAdapter</code></td>
</tr>
<tr>
<td style="text-align: left;"><code>std_msgs/msg/Float32(64)</code></td>
<td style="text-align: left;"><code>Floating32(64)</code></td>
<td style="text-align: left;"><code>_GenericStdAdapter</code></td>
</tr>
<tr>
<td style="text-align: left;"><code>std_msgs/msg/Bool</code></td>
<td style="text-align: left;"><code>Boolean</code></td>
<td style="text-align: left;"><code>_GenericStdAdapter</code></td>
</tr>
<tr>
<td style="text-align: left;"><code>tf2_msgs/msg/TFMessage</code></td>
<td style="text-align: left;"><code>FrameTransform</code> (ROS-specific)</td>
<td style="text-align: left;"><code>FrameTransformAdapter</code></td>
</tr>
</tbody>
</table>







  
  






                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
    
      
      <nav class="md-footer__inner md-grid" aria-label="Footer" >
        
          
          <a href="../ml/" class="md-footer__link md-footer__link--prev" aria-label="Previous: Machine Learning &amp; Analytics">
            <div class="md-footer__button md-icon">
              
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
            </div>
            <div class="md-footer__title">
              <span class="md-footer__direction">
                Previous
              </span>
              <div class="md-ellipsis">
                Machine Learning & Analytics
              </div>
            </div>
          </a>
        
        
          
          <a href="../../../daemon/" class="md-footer__link md-footer__link--next" aria-label="Next: Backend Overview">
            <div class="md-footer__title">
              <span class="md-footer__direction">
                Next
              </span>
              <div class="md-ellipsis">
                Backend Overview
              </div>
            </div>
            <div class="md-footer__button md-icon">
              
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11z"/></svg>
            </div>
          </a>
        
      </nav>
    
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      
      <script id="__config" type="application/json">{"annotate": null, "base": "../../..", "features": ["content.code.copy", "content.code.annotate", "navigation.instant", "navigation.sections", "navigation.path", "navigation.indexes", "navigation.tabs", "navigation.footer"], "search": "../../../assets/javascripts/workers/search.2c215733.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
    
    
      <script src="../../../assets/javascripts/bundle.79ae519e.min.js"></script>
      
    
  </body>
</html>